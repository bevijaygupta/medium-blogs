---
title: "MFA Vulnerability Exploited for Account Hijacking da8b1bc319fb"
platform: Medium
original_file: 2024-08-26_MFA-Vulnerability-Exploited-for-Account-Hijacking-da8b1bc319fb.md
---

# MFA Vulnerability Exploited for Account Hijacking da8b1bc319fb

::: {}
# MFA Vulnerability Exploited for Account Hijacking {#mfa-vulnerability-exploited-for-account-hijacking .p-name}
:::

::: {.section .p-summary field="subtitle"}
This blog is about how I was able to takeover the account and bypass
multifactor authentication using manual analysis. Take a seat belt
and...
:::

::::::: {.section .e-content field="body"}
:::::: {#a886 .section .section .section--body .section--first .section--last}
::: section-divider

------------------------------------------------------------------------
:::

:::: section-content
::: {.section-inner .sectionLayout--insetColumn}
### MFA Vulnerability Exploited for Account Hijacking {#ec0c .graf .graf--h3 .graf--leading .graf--title name="ec0c"}

<figure id="fb54" class="graf graf--figure graf-after--h3">
<img
src="https://cdn-images-1.medium.com/max/800/1*_PHp26tE6krI8FZu06e9Ng.png"
class="graf-image" data-image-id="1*_PHp26tE6krI8FZu06e9Ng.png"
data-width="2240" data-height="1260" />
</figure>

This blog is about how I was able to takeover the account and bypass
multifactor authentication using manual analysis. Take a seat belt and
enjoy, this gonna be long ride.

### Motivation {#0719 .graf .graf--h3 .graf-after--p name="0719"}

After a nearly year-long break from bug hunting due to work and Job, I
finally decided to resume hunting on weekend so I started searching for
platform / application based target rather than wildcard domain. Nearly
after a minutes I decided to hunt for app.*redacted*.com as it contained
new registration function and others.

<figure id="7d32" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*ogqSNuf5YEBlwiGC.gif"
class="graf-image" data-image-id="0*ogqSNuf5YEBlwiGC.gif"
data-width="498" data-height="245" data-is-featured="true" />
</figure>

### Let us Begin {#5f38 .graf .graf--h3 .graf-after--figure name="5f38"}

I always like to go with the steps if I finds registration/signup page I
first like to check if I can create anyone's account with their email
bypassing the authentication/verification code/link sent to their email.
I also like to play with parameter as much as possible so I did same on
this target also. The moment I landed on signup page I tried to register
a fresh new account then check all the true cases first. True cases
could be response of successful account creation, api/endpoints used and
other.

### About Web Application {#4ec8 .graf .graf--h3 .graf-after--p name="4ec8"}

Knowing about how the application functions is important to bypass
anything. So I realized that web application on creating new account it
sends xxxx-xxxx-xxxx digit format code to the email and requires to
enter to verify and active the account. Also after successfully creating
account there is a team section which automatically add you to the team
group if you belong to that org/domain. Means if you create a account on
platform with lets say *astute@tesla.com* you will automatically be
added to its Team group i.e. tesla.com in this case and you can
read/write all chats and photos of members sent on team group.

<figure id="2426" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*Tj0yRHI_pVuroH9w.png"
class="graf-image" data-image-id="0*Tj0yRHI_pVuroH9w.png"
data-width="875" data-height="569" />
</figure>

### Analysis and Approach {#73c2 .graf .graf--h3 .graf-after--figure name="73c2"}

Now I knew about how application works so I tried to bypass the
authentication aiming to create account with anyone's org/domain email.
I created an email lets say *astute@tesla.com and* obviously I don't
have access to that email*.* After playing with all the parameter, I
sent a random code which was obviously wrong code and intercepted the
request to see the parameters its using and then I saw a very big flaws
on its development.

<figure id="1ae8" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*uFJ9dFlCgdMuycUJ.jpg"
class="graf-image" data-image-id="0*uFJ9dFlCgdMuycUJ.jpg"
data-width="650" data-height="366" />
</figure>

The application was using a parameter called *grant_type* which was
responsible to authenticate or more like tell server how to verify the
code so that application server can create account. Lets look at the POC
to understand better.

<figure id="ffcb" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*iC6_84SSW_3-a3j-.png"
class="graf-image" data-image-id="0*iC6_84SSW_3-a3j-.png"
data-width="801" data-height="771" />
</figure>

As the POC screenshot might be enough to explain what happened in any
case I am writing. So basically I was able to bypass the authentication
that I required to enter xxxx-xxxx-xxxx code by just telling server that
I want to authenticate the token by not using that token but the
password.

Here is the catch, since the password I already knew as its the same
password I used to create account on signup page I can now just bypass
authencation and can create anyone's account and join the team and read
the chat.

<figure id="3dad" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*tXgFWNcsd3Miwlzh.gif"
class="graf-image" data-image-id="0*tXgFWNcsd3Miwlzh.gif"
data-width="480" data-height="270" />
</figure>

Wait Wait Wait!!

It's not that easy. Yup I was able to create account but still some
mechanism was there and saying it needs to make sure that the right
person is accessing.\
As this point I was little disappointed because you know the feeling
right when it so close yet so far.

<figure id="f8f8" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*pP4zZMGTa9JLNvBd.png"
class="graf-image" data-image-id="0*pP4zZMGTa9JLNvBd.png"
data-width="875" data-height="499" />
</figure>

### MFA Bypass {#d8af .graf .graf--h3 .graf-after--figure name="d8af"}

Now it was sending the activation link which on clicking gets activated.
I did the basic thing here which comes first to every pentesters mind. I
intercepted the request it was sending while making the api call to send
the activation code to the email. Here first I tried with my own email
to check what kinda activation link it's generating. Then I realized one
more bigger flaws then first one.

<figure id="e200" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*8IyvBejyipaHfoQT.gif"
class="graf-image" data-image-id="0*8IyvBejyipaHfoQT.gif"
data-width="480" data-height="480" />
</figure>

Actually the activation link was already reflecting on the response of
api call made, so basically I clould active the account without needing
access to the victim email.

<figure id="093b" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*GlnPkS1JIvoYGUxg.png"
class="graf-image" data-image-id="0*GlnPkS1JIvoYGUxg.png"
data-width="875" data-height="363" />
</figure>

API Request Call

<figure id="a1e5" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*RYvoukyyXjZDm1HR.png"
class="graf-image" data-image-id="0*RYvoukyyXjZDm1HR.png"
data-width="875" data-height="235" />
</figure>

Activation link sample on email

<figure id="8290" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*R5aDFFWs1j4JOR7i.png"
class="graf-image" data-image-id="0*R5aDFFWs1j4JOR7i.png"
data-width="765" data-height="758" />
</figure>

Afer successfull exploitation

Now I can create account with anyone's email and access all of it's
organizations stuff. Preety cool right!

<figure id="45d8" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*pfZrmH4cmEm8990W.gif"
class="graf-image" data-image-id="0*pfZrmH4cmEm8990W.gif"
data-width="480" data-height="270" />
</figure>

### Bonus {#cdfe .graf .graf--h3 .graf-after--figure name="cdfe"}

I am adding bonus here for reader, the injection was also possible on
the link that get generate for activation. Actually there was a
parameter called *content* which is getting reflected to the link on
activation. I cloud only inject the text on link itself but the injected
text was adding after ? so the activation link remained same which
doesn't led to open redirect or html/xss injection. Let me know what
other cloud have been possible on this test case.

<figure id="85eb" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*oujxK4_Ks9eAXptR.png"
class="graf-image" data-image-id="0*oujxK4_Ks9eAXptR.png"
data-width="875" data-height="541" />
</figure>

injectable parameter content

<figure id="23d6" class="graf graf--figure graf-after--p">
<img
src="https://cdn-images-1.medium.com/max/800/0*64s9nph5EGzebJ9t.png"
class="graf-image" data-image-id="0*64s9nph5EGzebJ9t.png"
data-width="875" data-height="231" />
</figure>

email recieved on victim account.

### Thank you for reading :) {#ca8a .graf .graf--h3 .graf-after--p name="ca8a"}

<figure id="cb40" class="graf graf--figure graf-after--h3">
<img
src="https://cdn-images-1.medium.com/max/800/0*7HmljMfsWYorHmZa.gif"
class="graf-image" data-image-id="0*7HmljMfsWYorHmZa.gif"
data-width="480" data-height="266" />
</figure>

### Promote and Collaborate on Cybersecurity Insights {#de42 .graf .graf--h3 .graf-after--figure name="de42"}

We are excited to offer promotional opportunities and guest post
collaborations on our blog and website, focusing on all aspects of
cybersecurity. Whether you're an expert with valuable insights to share
or a business looking to reach a wider audience, our platform provides
the perfect space to showcase your knowledge and services. Let's work
together to enhance our community's understanding of cybersecurity!

### About the Author: {#01b1 .graf .graf--h3 .graf-after--p name="01b1"}

[Vijay
Gupta](https://medium.com/@bevijaygupta/who-is-vijay-gupta-2ecad87f92a2){.markup--anchor
.markup--p-anchor
data-href="https://medium.com/@bevijaygupta/who-is-vijay-gupta-2ecad87f92a2"
rel="noopener" target="_blank"} is a cybersecurity enthusiast with
several years of experience in cyber security, [cyber crime forensics
investigation](https://play.google.com/store/books/details?id=VRz7EAAAQBAJ){.markup--anchor
.markup--p-anchor
data-href="https://play.google.com/store/books/details?id=VRz7EAAAQBAJ"
rel="noopener ugc nofollow noopener" target="_blank"}, and security
awareness training in schools and colleges. With a passion for
safeguarding digital environments and educating others about
cybersecurity best practices, Vijay has dedicated his career to
promoting cyber safety and resilience. Stay connected with Vijay Gupta
on various social media platforms and professional networks to access
valuable insights and stay updated on the latest cybersecurity trends.
:::
::::
::::::
:::::::

By [Vijay Kumar Gupta](https://medium.com/@bevijaygupta){.p-author
.h-card} on [August 26, 2024](https://medium.com/p/da8b1bc319fb).

[Canonical
link](https://medium.com/@bevijaygupta/mfa-vulnerability-exploited-for-account-hijacking-da8b1bc319fb){.p-canonical}

Exported from [Medium](https://medium.com) on February 9, 2026.
